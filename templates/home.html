{% extends 'base.html' %}

{% block content %}
<!-- بداية البحث -->
<div class="container mt-5">
    <h1 class="mb-4 text-center">الصفحة الرئيسية</h1>
    {% if user.is_authenticated %}
        <p class="text-center">مرحبًا، {{ user.username }}!</p>
    {% else %}
        <p class="text-center">مرحبًا، زائر!</p>
    {% endif %}

    <!-- حقل البحث السريع -->
    <div class="mb-4">
        <input type="text" id="quickSearch" class="form-control" placeholder="ابحث عن فاتورة أو مادة...">
    </div>

    <!-- عرض الشعار إذا تم رفعه -->
    <div class="row">
        <!-- العمود الأيسر (المحتوى الرئيسي) -->
        <div class="col-md-9">
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <i class="fas fa-file-invoice"></i> إدارة الفواتير
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'invoice_list' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-list"></i> قائمة الفواتير
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع الفواتير">?</span>
                            </a>
                            <a href="{% url 'invoice_create' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-plus"></i> إنشاء فاتورة جديدة
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء فاتورة جديدة">?</span>
                            </a>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <i class="fas fa-box"></i> إدارة المواد
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'product_list' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-list"></i> قائمة المواد
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع المواد">?</span>
                            </a>
                            <a href="{% url 'product_create' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-plus"></i> إنشاء مادة جديدة
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء مادة جديدة">?</span>
                            </a>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <i class="fas fa-shipping-fast"></i> إدارة شركات الشحن
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'shipping_list' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-list"></i> قائمة شركات الشحن
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع شركات الشحن">?</span>
                            </a>
                            <a href="{% url 'shipping_create' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-plus"></i> إنشاء شركة شحن جديدة
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء شركة شحن جديدة">?</span>
                            </a>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <i class="fas fa-shipping-fast"></i> إدارة العملات
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'currency_list' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-list"></i> قائمة العملات
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع العملات">?</span>
                            </a>
                            <a href="{% url 'currency_create' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-plus"></i> إنشاء عملة  
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء عملة جديدة">?</span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-warning text-dark">
                            <i class="fas fa-coins"></i> إدارة المشتريات 
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'purchase_list' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-list"></i> قائمة فواتير المشتريات 
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع العملات">?</span>
                            </a>
                            <a href="{% url 'purchase_create' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-plus"></i> إنشاء فاتورة المشتريات
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء عملة جديدة">?</span>
                            </a>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header bg-danger text-white">
                            <i class="fas fa-file-alt"></i> إدارة حالات الفاتورة
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'status_list' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-list"></i> قائمة حالات الفاتورة
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع حالات الفاتورة">?</span>
                            </a>
                            <a href="{% url 'status_create' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-plus"></i> إنشاء حالة فاتورة جديدة
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء حالة فاتورة جديدة">?</span>
                            </a>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header bg-secondary text-white">
                            <i class="fas fa-tags"></i> إدارة أنواع الأسعار
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'pricetype_list' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-list"></i> قائمة أنواع الأسعار
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع أنواع الأسعار">?</span>
                            </a>
                            <a href="{% url 'pricetype_create' %}" class="list-group-item list-group-item-action">
                                <i class="fas fa-plus"></i> إنشاء نوع سعر جديد
                                <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء نوع سعر جديد">?</span>
                            </a>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header bg-dark text-white">
                            <i class="fas fa-user"></i> إدارة الحساب
                        </div>
                        <div class="list-group list-group-flush">
                            {% if user.is_authenticated %}
                                <a href="{% url 'accounts:logout' %}" class="list-group-item list-group-item-action">
                                    <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                                    <span class="float-end text-warning" data-bs-toggle="tooltip" title="تسجيل الخروج من الحساب">?</span>
                                </a>
                            {% else %}
                                <a href="{% url 'accounts:login' %}" class="list-group-item list-group-item-action">
                                    <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
                                    <span class="float-end text-warning" data-bs-toggle="tooltip" title="تسجيل الدخول إلى الحساب">?</span>
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- العمود الأيمن (رفع الشعار وإدارة الباركود) -->
        <div class="col-md-3">
            <!-- قسم رفع الشعار -->
            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    <i class="fas fa-image"></i> شعار الشركة
                </div>
                <div class="card-body">
                    <!-- رفع شعار الشركة -->
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="company_logo" class="form-label">رفع شعار الشركة:</label>
                            <input type="file" class="form-control" id="company_logo" name="company_logo" accept="image/*">
                        </div>
                        <div class="mb-3">
                            <label for="logo_width" class="form-label">عرض الشعار (بالبكسل):</label>
                            <input type="number" class="form-control" id="logo_width" name="logo_width" value="200">
                        </div>
                        <div class="mb-3">
                            <label for="logo_height" class="form-label">ارتفاع الشعار (بالبكسل):</label>
                            <input type="number" class="form-control" id="logo_height" name="logo_height" value="100">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">رفع الشعار</button>
                    </form>

                    <!-- عرض الشعار إذا تم رفعه -->
                    {% if company_logo_url %}
                        <img src="{{ company_logo_url }}" alt="شعار الشركة" class="img-fluid" style="width: {{ logo_width|default:'200px' }}; height: {{ logo_height|default:'100px' }};">
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- قسم إدارة الباركود -->
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    <i class="fas fa-barcode"></i> إدارة الباركود
                </div>
                <div class="list-group list-group-flush">
                    <a href="{% url 'barcode_list' %}" class="list-group-item list-group-item-action">
                        <i class="fas fa-list"></i> قائمة الباركودات
                        <span class="float-end text-warning" data-bs-toggle="tooltip" title="عرض جميع الباركودات">?</span>
                    </a>
                    <a href="{% url 'barcode_create' %}" class="list-group-item list-group-item-action">
                        <i class="fas fa-plus"></i> إنشاء باركود جديد
                        <span class="float-end text-warning" data-bs-toggle="tooltip" title="إنشاء باركود جديد">?</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- نهاية البحث-->

<script>
document.addEventListener('DOMContentLoaded', function () {
    const quickSearch = document.getElementById('quickSearch');
    quickSearch.addEventListener('input', function () {
        const searchTerm = this.value.toLowerCase();
        const links = document.querySelectorAll('.list-group-item');

        links.forEach(link => {
            const linkText = link.textContent.toLowerCase();
            if (linkText.includes(searchTerm)) {
                link.style.display = 'block';
            } else {
                link.style.display = 'none';
            }
        });
    });
});
</script>

<!-- إضافة مكتبة Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- تفعيل الـ Tooltips -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
});
</script>

<!-- تنسيق علامة الاستفهام -->
<style>
    .float-end.text-warning {
        margin-left: 10px;  /* مسافة بين النص وعلامة الاستفهام */
        font-weight: bold;  /* جعل علامة الاستفهام غامقة */
        cursor: pointer;    /* تغيير شكل المؤشر عند التمرير */
    }

    /* تنسيقات إضافية */
    .card-header {
        font-size: 1.2rem;
        font-weight: bold;
    }

    .list-group-item {
        font-size: 1rem;
    }

    .form-control {
        margin-bottom: 10px;
    }

    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
    }

    .btn-primary:hover {
        background-color: #0056b3;
        border-color: #0056b3;
    }

    .img-fluid {
        max-width: 100%;
        height: auto;
    }
</style>
{% endblock %}